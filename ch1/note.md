# 第 1 章：计算机系统漫游

## 1.1 信息就是位+上下文

- 位/比特：一个0/1值
- 字节：8个位

> 系统中所有的信息——包括磁盘文件、内存中的程序、内存中存放的用户数据以及网络上传送的数据，都是由一串比特表示的。区分不同数据对象的唯一方法是我们读到这些数据对象时的上下文。比如，在不同的上下文中，一个同样的字节序列可能表示一个整数、浮点数、字符串或者机器指令。

## 1.2 程序被其他程序翻译成不同的格式

\[源程序(文本)\] --预处理器(cpp)-->  \[修改了的源程序(文本)\] --编译器(ccl)--> \[汇编程序(文本)\] --汇编器(as)--> \[可重定位目标程序(二进制)\] --链接器(ld)--> \[可执行目标程序(二进制)\]

编译系统：
- 预处理：根据 `#` 开头的命令修改原始的c程序
- 编译：将 修改了的源程序(文本) 翻译成 汇编程序(文本)。不同高级语言的不同编译器会输出同样的汇编语言
- 汇编：将 汇编程序(文本) 翻译成机器语言指令，把这些指令打包成 可重定位目标程序 格式
- 链接：处理 `printf` 这种调用，printf 函数存在于一个名为 printf.o 的单独的预编译好了的目标文件中，链接器将这个 .o 与我们生成的 .o 合并起来

## 1.3 了解编译系统如何工作是大有益处的

- 优化程序性能
- 理解链接时出现的错误
- 避免安全漏洞

## 1.4 处理器读并解释储存在内存中的指令

- 总线
- I/O设备：通过控制器或适配器与I/O总线相连
- 主存：由一组动态随机存取存储器（DRAM）芯片组成；从逻辑上来说是一个线性的字节数组，每个字节都有其唯一的地址
- 处理器（中央处理单元，CPU）：解释/执行存储在主存中指令的引擎
  - 程序计数器PC：是一个大小为一个字的存储设备，指向主存中的某条机器语言指令
  - 算数逻辑单元ALU
  - 寄存器文件register file：一个小的存储设备，由一些单个字长的寄存器组成，每个寄存器都有唯一的名字

## 1.5 高速缓存至关重要

- 寄存器文件存储小，但是速度快，主存存储大但速度慢
- 在处理器（寄存器）和主存中加入高速缓存（cache memory），存放处理器近期可能会需要的信息
- cache的硬件技术：静态随机访问存储器（SRAM）
- 多级缓存L1 L2 L3...

## 1.6 存储设备形成层次结构

寄存器 - L1 - L2 - L3 - 主存（DRAM） - 本地二级存储（本地磁盘）- 远程二级存储（分布式文件系统，web服务器）

## 1.7 操作系统管理硬件

应用程序 - 操作系统 - 处理器&主存&I/O设备

操作系统的基本功能：
- 防止硬件被失控的应用程序滥用
- 向应用程序提供简单一致的机制来控制复杂而又通常大不相同的低级硬件设备

操作系统的抽象概念：
- 文件：是对 I/O设备 的抽象
- 虚拟内存：是对 主存和I/O设备 的抽象
- 进程：是对 处理器、主存和I/O设备 的抽象

### 1.7.1 进程

进程：操作系统对一个正在运行的程序的一种抽象

操作系统通过**上下文切换**机制实现并发运行，这种进程间的切换是由操作系统**内核**管理的（内核不是一个独立的进程，而是系统管理全部进程所用代码和数据结构的集合）

### 1.7.2 线程

- 一个进程可以由多个线程组成
- 每个线程都运行在进程的上下文中，并共享同样的代码和全局数据

### 1.7.3 虚拟内存

- 为每个进程提供了一个假象，即每个进程都在独占地使用主存
- 每个进程看到的内存都是一致的，称为虚拟地址空间

虚拟地址空间构成（从低地址到高地址）：
- 程序代码和数据
- 堆
- 共享库
- 栈
- 内核虚拟内存

### 1.7.4 文件

- 文件就是字节序列
- 向应用程序提供了一个统一的试图，来看待系统中可能含有的所有各式各样的I/O设备

## 1.8 系统之间利用网络通信

对于一个单独的系统，网络可视为一个I/O设备

## 1.9 重要主题

### 1.9.1 Amdahl定律

当我们对系统的某个部分加速时，其对系统整体性能的影响取决于该部分的重要性和加速程度（公式略）

### 1.9.2 并发和并行

- 并发（concurrency）：指一个同时具有多个活动的系统
- 并行（parallelism）：指用并发来使一个系统运行得更快

由高到低的顺序：
- 线程级并发
- 指令集并行
- 单指令、多数据并行

### 1.9.3 计算机系统中抽象的重要性
